<!DOCTYPE html><head><meta charset="UTF-8"><title>Petrov Galerkin approach for Lagrange multipliers | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="dea57fbb-90bc-49af-bfed-5059dbe3cfa9" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="8697e517-54de-41b2-bb06-d7c444426916" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e2bbb817-fe91-4fc0-959c-3d8f6472fd1b" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="ffabba6d-1604-402d-bc4d-2297e732f698"><i class="material-icons">menu</i></a><ul class="sidenav" id="ffabba6d-1604-402d-bc4d-2297e732f698"><li><a href="#!" class="dropdown-trigger" data-target="afaa0538-6fbc-4117-9844-8a5883ef2860" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="a296af67-0da9-4b43-9b95-8162885f994e" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e524c106-a627-4e76-9d8c-518eb02c80b7" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="dea57fbb-90bc-49af-bfed-5059dbe3cfa9"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="8697e517-54de-41b2-bb06-d7c444426916"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="e2bbb817-fe91-4fc0-959c-3d8f6472fd1b"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="afaa0538-6fbc-4117-9844-8a5883ef2860"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="a296af67-0da9-4b43-9b95-8162885f994e"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="e524c106-a627-4e76-9d8c-518eb02c80b7"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">Constraints</a><a href="#" class="breadcrumb">Petrov-Galerkin_approach_for_Lagrange_multipliers</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="4f847e37-b3a5-4bc9-bb87-518371491967" data-section-level="1" data-section-text="Petrov - Galerkin approach for Lagrange multipliers"><h1 id="petrov-galerkin-approach-for-lagrange-multipliers">Petrov-Galerkin approach for Lagrange multipliers</h1><section class="scrollspy" id="88431dc1-22cc-4c28-878b-b937a4b70abc" data-section-level="2" data-section-text="Overview"><h2 id="overview">Overview</h2><p>The Petrov–Galerkin method is acknowledged to be a numerical method used to approximate solutions of partial differential equations where the test function and solution function belong to different function spaces.</p><p>For mortar-based mechanical contact, when dual shape function is utilized for the Lagrange multiplier variable, we may end up with a negative weighted gap value at certain nodes. This negative weighted gap value not only contradicts the continuum setting, but also may lead to unacceptable errors or even a non-converging active set strategy.</p><p>In order to resolve this issue, a Petrov–Galerkin interpolation for the Lagrange multiplier is proposed (see e.g., <a href="#popp2014dual">Popp and Wall (2014)</a>). Specifically, dual shape functions are employed for the Lagrange multiplier field, thus resulting in the desired diagonal structure of mortar matrix, which allows for the condensation of the discrete Lagrange multiplier degrees of freedom (see <a href="../../source/preconditioners/VariableCondensationPreconditioner.html">VCP</a>). On the other hand, the interpolation of its variation in the constraint equations is done by standard shape functions. To this end, this approach combines the strengths of both standard and dual Lagrange multiplier interpolation methods. Mathematically, this means</p><p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-d6157064-669b-40c5-a8f9-79cf4f9dd6be"></span><script>var element = document.getElementById("moose-equation-d6157064-669b-40c5-a8f9-79cf4f9dd6be");katex.render("\\begin{split} \\lambda & = \\sum_{i=0}^{n_\\lambda} \\Phi_i \\lambda_i,\\\\ \\delta \\lambda & = \\sum_{i=0}^{n_\\lambda} N_i \\delta\\lambda_i, \\end{split}", element, {displayMode:true,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-16e07f21-90e6-4021-bda3-b3051aad0207"><script>var element = document.getElementById("moose-equation-16e07f21-90e6-4021-bda3-b3051aad0207");katex.render("\\lambda", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-b9606080-d3d0-4b47-b3c9-f93faf77b5d3"><script>var element = document.getElementById("moose-equation-b9606080-d3d0-4b47-b3c9-f93faf77b5d3");katex.render("\\delta \\lambda", element, {displayMode:false,throwOnError:false});</script></span> are the Lagrange multiplier variable and its variation, respectively.  The <span class="moose-katex-inline-equation" id="moose-equation-59c11338-cff2-4f94-b3d5-59be3c9752d8"><script>var element = document.getElementById("moose-equation-59c11338-cff2-4f94-b3d5-59be3c9752d8");katex.render("n_\\lambda", element, {displayMode:false,throwOnError:false});</script></span> is the total number of nodes along the secondary contact interface. The <span class="moose-katex-inline-equation" id="moose-equation-8d49c295-b869-41d8-b0a8-71540ac43355"><script>var element = document.getElementById("moose-equation-8d49c295-b869-41d8-b0a8-71540ac43355");katex.render("\\lambda_i", element, {displayMode:false,throwOnError:false});</script></span> and <span class="moose-katex-inline-equation" id="moose-equation-457c84a5-6bbb-4108-b502-6fa0a8293ad9"><script>var element = document.getElementById("moose-equation-457c84a5-6bbb-4108-b502-6fa0a8293ad9");katex.render("\\delta\\lambda_i", element, {displayMode:false,throwOnError:false});</script></span> are the discretized nodal values of the Lagrange multiplier variable and its variation, respectively. The <span class="moose-katex-inline-equation" id="moose-equation-b58a656e-c84e-4673-ad3b-8bbbccce99b2"><script>var element = document.getElementById("moose-equation-b58a656e-c84e-4673-ad3b-8bbbccce99b2");katex.render("\\Phi_i", element, {displayMode:false,throwOnError:false});</script></span> is the dual basis function, the <span class="moose-katex-inline-equation" id="moose-equation-73cbe453-f7d8-488e-b9eb-c9feba4c9296"><script>var element = document.getElementById("moose-equation-73cbe453-f7d8-488e-b9eb-c9feba4c9296");katex.render("N_i", element, {displayMode:false,throwOnError:false});</script></span> is the standard basis function.</p></section><section class="scrollspy" id="21b95bf9-be91-48b0-897b-0ee4845ab60b" data-section-level="2" data-section-text="Implementation and Usage Details"><h2 id="implementation-and-usage-details">Implementation and Usage Details</h2><p>The Petrov-Galerkin method is implemented in MOOSE by overwriting the Lagrange multiplier&#x27;s (dual) test functions using that of a standard Lagrange multiplier variable. This functionality is enabled for all mortar-based constraints and the weighted-gap user object.</p><p>To successfully use this approach in the contact action, one just needs to set <code>use_petrov_galerkin = true</code> in the <code>Contact</code> block. For example:</p><pre style="max-height:350px;"><code class="language-text">
[Contact]
  [mortar]
    primary = &#x27;bottom_top&#x27;
    secondary = &#x27;top_bottom&#x27;
    formulation = mortar
    model = coulomb
    friction_coefficient = 0.4
    c_normal = 1e4
    c_tangential = 1.0e4
    use_petrov_galerkin = true
  []
[]
</code></pre><p>To successfully use this approach in <code>Constraints</code> based input, one needs to enable dual shape function interpolation of the Lagrange multiplier variables (<code>use_dual = true</code>). Additionally, one needs to define a dummy auxiliary variable on the secondary interface that utilizes standard test/shape functions. An example syntax is as follows:</p><pre style="max-height:350px;"><code class="language-text">
[AuxVariables]
  [aux_lm]
    block = &#x27;secondary_lower&#x27;
    order = SECOND # needs to be consistent with the Lagrange multiplier variable
    use_dual = false
  []
[]
</code></pre><p>Then enable Petrov-Galerkin in mortar-based Constraint as follows:</p><pre style="max-height:350px;"><code class="language-text">
[Constraints]
  [example_mortar_constraint]
    type = ...
    ...
    ...
    use_petrov_galerkin = true
    aux_lm = aux_lm
  []
[]
</code></pre><p>Similarly, in the <code>LMWeightedGapUserObject</code>:</p><pre style="max-height:350px;"><code class="language-text">
[UserObjects]
  [weighted_gap_uo]
    type = LMWeightedGapUserObject
    ...
    ...
    use_petrov_galerkin = true
    aux_lm = aux_lm
  []
[]
</code></pre><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p>One can enable Petrov-Galerkin for mortar-based constraints not limited to mechanical contact (e.g., gap conductance). It is up to the user&#x27;s discretion about the meaningful usage of Petrov-Galerkin interpolation for the Lagrange multipliers.</p></div></div></div></section><section class="scrollspy" id="7787ea04-e75d-492e-b994-0197ae2d68f3" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="popp2014dual">Alexander Popp and WA&nbsp;Wall.
Dual mortar methods for computational contact mechanics–overview and recent developments.
<em>GAMM-Mitteilungen</em>, 37(1):66–84, 2014.<a href="#ea954bc9-7cba-4b3f-b7d0-181383f58e21" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="ea954bc9-7cba-4b3f-b7d0-181383f58e21"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{popp2014dual,
    author = "Popp, Alexander and Wall, WA",
    title = "Dual mortar methods for computational contact mechanics--overview and recent developments",
    journal = "GAMM-Mitteilungen",
    volume = "37",
    number = "1",
    pages = "66--84",
    year = "2014",
    publisher = "Wiley Online Library"
}
</code></pre></div></div></li></ol></div></section></section></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#88431dc1-22cc-4c28-878b-b937a4b70abc" class="tooltipped" data-position="left" data-tooltip="Overview">Overview</a></li><li><a href="#21b95bf9-be91-48b0-897b-0ee4845ab60b" class="tooltipped" data-position="left" data-tooltip="Implementation and Usage Details">Implementation and Usage Details</a></li><li><a href="#7787ea04-e75d-492e-b994-0197ae2d68f3" class="tooltipped" data-position="left" data-tooltip="References">References</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>