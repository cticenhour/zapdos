<!DOCTYPE html><head><meta charset="UTF-8"><title>Controls System | Zapdos</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/zapdos.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Zapdos</a><a href="https://github.com/shannon-lab/zapdos" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="71b885b1-4374-4c73-9977-947af4d34bae" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="0dd5dbaa-ebc6-4109-8328-ab2ecff92284" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="885b0a73-ebb6-4ad8-8832-e374d766ca19" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="e1bbaacf-ccb8-4463-965e-c47adee3aa7d"><i class="material-icons">menu</i></a><ul class="sidenav" id="e1bbaacf-ccb8-4463-965e-c47adee3aa7d"><li><a href="#!" class="dropdown-trigger" data-target="691739c6-e11c-4f78-9901-77dd76651ba2" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="b1b13e25-dad8-4bd6-927c-250cd58c93f9" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="e55e8225-3b3b-4988-a463-39551782da70" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="71b885b1-4374-4c73-9977-947af4d34bae"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="0dd5dbaa-ebc6-4109-8328-ab2ecff92284"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="885b0a73-ebb6-4ad8-8832-e374d766ca19"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul><ul class="dropdown-content" id="691739c6-e11c-4f78-9901-77dd76651ba2"><li><a href="../../getting_started/installation.html">Installation</a></li><li><a href="../../getting_started/using_zapdos.html">Using Zapdos</a></li><li><a href="../../getting_started/zapdos_meshing.html">Generating Meshes</a></li><li><a href="../../tutorial/index.html">Tutorial Slides</a></li></ul><ul class="dropdown-content" id="b1b13e25-dad8-4bd6-927c-250cd58c93f9"><li><a href="../zapdos_only.html">Zapdos Input Syntax</a></li><li><a href="../index.html">Complete Code Syntax</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/libmesh/classes.html">libMesh Doxygen</a></li><li><a href="../../a-to-z.html">Zapdos A to Z Index</a></li><li><a href="../../examples/crane_examples.html">CRANE Examples</a></li><li><a href="../../development/contributing.html">Contributing Guidelines</a></li><li><a href="../../development/code_standards.html">Code Standards</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="e55e8225-3b3b-4988-a463-39551782da70"><li><a href="https://github.com/shannon-lab/zapdos/discussions">Zapdos Discussions Forum</a></li><li><a href="../../development/zapdos_developer_info.html">Zapdos Developer Information</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussions Forum</a></li><li><a href="https://mooseframework.inl.gov/">MOOSE Homepage</a></li><li><a href="../../development/moose_developer_info.html">MOOSE Developer Information</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">Controls</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="60a94fa2-b3da-42d5-a095-61826c0bba9f" data-section-level="1" data-section-text="Controls System"><h1 id="controls-system">Controls System</h1><p>The Controls system in MOOSE has one primary purpose: <strong>to modify input parameters during runtime of a MOOSE-based simulation</strong>.</p><p>If a developer has marked a MOOSE object input parameter as <em>controllable</em>, that parameter may be controlled during a simulation using <code>Control</code> objects. <code>Control</code> objects are defined in the input file in the <code>Controls</code> block, similar to other systems in MOOSE. For example, the following input file snippet shows the use of the <a href="../../source/controls/RealFunctionControl.html">RealFunctionControl</a> object.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 1: </span><span class="moose-caption-text" id="controls_example">Example of a Control object used in a MOOSE input file.</span></p><pre style="max-height:350px;"><code class="language-moose">[Kernels&lt;&lt;&lt;{&quot;href&quot;: &quot;../Kernels/index.html&quot;}&gt;&gt;&gt;]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative&lt;&lt;&lt;{&quot;description&quot;: &quot;The time derivative operator with the weak form of $(\\psi_i, \\frac{\\partial u_h}{\\partial t})$.&quot;, &quot;href&quot;: &quot;../../source/kernels/TimeDerivative.html&quot;}&gt;&gt;&gt;
    variable&lt;&lt;&lt;{&quot;description&quot;: &quot;The name of the variable that this residual object operates on&quot;}&gt;&gt;&gt; = u
  [../]
[]

[Controls&lt;&lt;&lt;{&quot;href&quot;: &quot;index.html&quot;}&gt;&gt;&gt;]
  [./func_control]
    type = RealFunctionControl&lt;&lt;&lt;{&quot;description&quot;: &quot;Sets the value of a &#x27;Real&#x27; input parameters to the value of a provided function.&quot;, &quot;href&quot;: &quot;../../source/controls/RealFunctionControl.html&quot;}&gt;&gt;&gt;
    parameter&lt;&lt;&lt;{&quot;description&quot;: &quot;The input parameter(s) to control. Specify a single parameter name and all parameters in all objects matching the name will be updated&quot;}&gt;&gt;&gt; = &#x27;*/*/coef&#x27;
    function&lt;&lt;&lt;{&quot;description&quot;: &quot;The function to use for controlling the specified parameter.&quot;}&gt;&gt;&gt; = &#x27;func_coef&#x27;
    execute_on&lt;&lt;&lt;{&quot;description&quot;: &quot;The list of flag(s) indicating when this object should be executed. For a description of each flag, see https://mooseframework.inl.gov/source/interfaces/SetupInterface.html.&quot;}&gt;&gt;&gt; = &#x27;initial timestep_begin&#x27;
  [../]
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#fb40f271-e67f-481f-b2a0-8f6825fd10f4">(moose/test/tests/controls/real_function_control/real_function_control.i)</a></div></div><p>Here, <code>func_control</code> controls the <code>coef</code> parameter of the <code>diff</code> object. See <a href="index.html#object-and-parameter-names">Object and Parameter Names</a> for the allowable syntax to specify controlled parameters.</p><section class="scrollspy" id="297b983a-28e1-4402-b5ac-d0eced613541" data-section-level="2" data-section-text="Making a Parameter Controllable"><h2 id="sec:control-param">Making a Parameter Controllable</h2><p>The input parameters of objects you wish to be controlled must:</p><ul class="browser-default"><li><p>Be marked as &quot;controllable&quot;. In the <code>validParams()</code> method for the class, the <code>InputParameters::declareControllable(param_names)</code> method is used as shown in <a href="#declare_controllable_listing">Listing 6</a>. Note that <code>param_names</code> may be a list of parameter names separated by spaces, e.g., <code>&quot;param1 param2 param3&quot;</code>.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 6: </span><span class="moose-caption-text" id="declare_controllable_listing">Example <code>validParams</code> method that declares a parameter as controllable.</span></p><pre style="max-height:350px;"><code class="language-cpp">InputParameters
DirichletBC::validParams()
{
  InputParameters params = DirichletBCBase::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;Value of the BC&quot;);
  params.declareControllable(&quot;value&quot;);
  params.addClassDescription(&quot;Imposes the essential boundary condition $u=g$, where $g$ &quot;
                             &quot;is a constant, controllable value.&quot;);
  return params;
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#e409a2bd-7724-4e93-bee7-2bc0769111af">(moose/framework/src/bcs/DirichletBC.C)</a></div></div></li><li><p>Be stored as <code>const</code> references; for example, in the <code>.h</code> file,</p><pre style="max-height:350px;"><code class="language-cpp">  const Real &amp; _value;
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#73624009-9cbd-4669-abed-f344d6d4616d">(moose/framework/include/bcs/DirichletBC.h)</a><p>which is initialized in the <code>.C</code> file using <code>getParam&lt;T&gt;(param)</code>, as usual:</p><pre style="max-height:350px;"><code class="language-cpp">  : DirichletBCBase(parameters), _value(getParam&lt;Real&gt;(&quot;value&quot;))
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#5bb1b507-232d-449a-aa62-80892d48128a">(moose/framework/src/bcs/DirichletBC.C)</a></li></ul><div class="card moose-alert moose-alert-tip"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">school</i><span class="moose-alert-title-brand">tip:</span>Parameter controllability listed on documentation pages</div><div class="card-content"><div class="moose-alert-content"><p>Each class documentation page lists whether each of its input parameters are controllable. For example, see the <a href="../../source/bcs/DirichletBC.html#input-parameters">DirichletBC</a> page.</p></div></div></div></section><section class="scrollspy" id="00614da0-0a28-49f5-bbe6-b5b9d4851beb" data-section-level="2" data-section-text="Developing a New Control"><h2 id="developing-a-new-control">Developing a New Control</h2><p><code>Control</code> objects are similar to other systems in MOOSE. You create a control in your application by inheriting from the <code>Control</code> C++ class in MOOSE. It is required to override the <code>execute</code> method in your custom object. Within this method the following methods are generally used to get or set controllable parameters:</p><ul class="browser-default"><li><p><code>getControllableValue</code> &lt;br&gt; This method returns the current controllable parameter, in the case that multiple parameters are being controlled, only the first value will be returned and a warning will be produced if the values are differ (this warning may be disabled).</p><p></p></li><li><p><code>setControllableValue</code> &lt;br&gt; This method allows for a controllable parameter to be changed, in the case that multiple parameters are being controlled, all of the values will be set.</p></li></ul><p>These methods operator in a similar fashion as other systems in MOOSE (e.g., <code>getPostprocessorValue</code> in the <a href="/Postprocessors/index.md">Postprocessors</a> system), each expects an input parameter name (<code>std::string</code>) that is prescribed in the <code>validParams</code> method.</p><p>There are additional overloaded methods that allow for the setting and getting of controllable values with various inputs for prescribing the parameter name, but the two listed above are generally what is needed.  Please refer to the source code for a complete list.</p></section><section class="scrollspy" id="6346823d-ff6a-478d-b6cf-5b66b441625f" data-section-level="2" data-section-text="Object and Parameter Names"><h2 id="object-and-parameter-names">Object and Parameter Names</h2><p>The objective of a <code>Control</code> object is to control parameters of one or more other objects; these parameters to control are specified by input parameters of the <code>Control</code>. <a href="#controls_example">Listing 1</a> shows an example syntax for specifying input parameters in the <code>parameter</code> parameter. In this example, <code>*/*/coef</code> is specified, which would match any controllable parameter named <code>coef</code> at that nesting level. In the example, there is only one parameter that the pattern matches, so <code>Kernels/diff/coef</code> would be equivalent. The &quot;/&quot;-separated path preceding the parameter name corresponds to the syntax blocks under which the parameter is located, such as for the system name and object name.</p><p>In similar fashion, object names can be requested by controls (e.g., as in the <a href="../../source/controls/TimePeriod.html"><code>TimePeriod</code></a>). In this case, the general naming scheme is the same as above but the parameter name is not included, e.g., <code>Kernels/diff</code>.</p><p>In both cases there is an alternative form for defining an object and parameter names: <code>base::object/name</code>. In this case &quot;base&quot; is the MOOSE base system that the object is derived from. For example, <code>Kernel::diff/coef</code>. All MOOSE &quot;bases&quot; are listed bellow:</p><ul class="browser-default"><li><p>ArrayAuxKernel, </p></li><li><p>ArrayKernel, </p></li><li><p>AuxKernel, </p></li><li><p>AuxScalarKernel, </p></li><li><p>BoundaryCondition, </p></li><li><p>Constraint, </p></li><li><p>Damper, </p></li><li><p>DGKernel, </p></li><li><p>DiracKernel, </p></li><li><p>Distribution, </p></li><li><p>EigenKernel, </p></li><li><p>Executioner, </p></li><li><p>Executor, </p></li><li><p>Function, </p></li><li><p>FVBoundaryCondition, </p></li><li><p>FVInterfaceKernel, </p></li><li><p>FVKernel, </p></li><li><p>Indicator, </p></li><li><p>InitialCondition, </p></li><li><p>InterfaceKernel, </p></li><li><p>Kernel, </p></li><li><p>LineSearch, </p></li><li><p>Marker, </p></li><li><p>MaterialBase, </p></li><li><p>MeshGenerator, </p></li><li><p>MooseMesh, </p></li><li><p>MoosePartitioner, </p></li><li><p>MoosePreconditioner, </p></li><li><p>MooseVariableBase, </p></li><li><p>MultiApp, </p></li><li><p>NodalKernel, </p></li><li><p>Output, </p></li><li><p>Postprocessor, </p></li><li><p>Predictor, </p></li><li><p>Problem, </p></li><li><p>RelationshipManager., </p></li><li><p>Reporter, </p></li><li><p>Sampler, </p></li><li><p>ScalarInitialCondition, </p></li><li><p>ScalarKernel, </p></li><li><p>Split, </p></li><li><p>TimeIntegrator, </p></li><li><p>TimeStepper, </p></li><li><p>Transfer, </p></li><li><p>UserObject, </p></li><li><p>VectorAuxKernel, </p></li><li><p>VectorInterfaceKernel, </p></li><li><p>VectorKernel, </p></li><li><p>VectorPostprocessor,</p></li></ul><p>MOOSE allows objects to define a <code>tag</code> name to access its controllable parameters with their <code>control_tags</code> parameter.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 2: </span><span class="moose-caption-text" id="controls_tags">Example of the parameter control_tags.</span></p><pre style="max-height:350px;"><code class="language-moose">[Postprocessors&lt;&lt;&lt;{&quot;href&quot;: &quot;../Postprocessors/index.html&quot;}&gt;&gt;&gt;]
  [./test_object]
    type = TestControlPointPP
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
  [./other_point_test_object]
    type = TestControlPointPP
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#0ea4ed8c-cfa6-4193-9011-13c227756c41">(moose/test/tests/controls/tag_based_naming_access/param.i)</a></div></div><p>The two postprocessors in <a href="#controls_tags">Listing 2</a> declare the same control tag <code>tag</code>. Thus their controllable parameter <code>point</code> can be set by controls simultaneously with <code>tag/*/point</code> as in <a href="#controls_tags_use">Listing 3</a>.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 3: </span><span class="moose-caption-text" id="controls_tags_use">Example of using the tagged controllable parameters.</span></p><pre style="max-height:350px;"><code class="language-moose">[Controls&lt;&lt;&lt;{&quot;href&quot;: &quot;index.html&quot;}&gt;&gt;&gt;]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f4a8ff50-dbda-4009-ae76-7bcf9b35d940">(moose/test/tests/controls/tag_based_naming_access/param.i)</a></div></div><div class="card moose-alert moose-alert-note"><div class="card-title moose-alert-title"><i class="material-icons moose-inline-icon">comment</i><span class="moose-alert-title-brand">note</span></div><div class="card-content"><div class="moose-alert-content"><p>The tag name does not include the object name although the tag name is added by an object. To access a controllable parameter, the syntax is <code>tag/object/name</code>. Internally, MOOSE adds the input block name as a special tag name.</p></div></div></div></section><section class="scrollspy" id="013703ce-9ae6-4f1f-9b55-b45ba9fe6442" data-section-level="2" data-section-text="Controllable Parameters Added by Actions"><h2 id="controllable_params_added_by_actions">Controllable Parameters Added by Actions</h2><p>MOOSE also allows parameters in <a href="../../source/actions/Action.html">Actions</a> to be controllable. The procedure for making a parameter in an <a href="../../source/actions/Action.html">Action</a> controllable is the same as documented in <a href="index.html#sec:control-param">Making a Parameter Controllable</a>. It is important that this controllable parameter must be directly connected with the parameters of MOOSE objects, such as kernels, materials, etc., using this parameter.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 4: </span><span class="moose-caption-text" id="connect_controllable">Example of connecting controllable parameters in an action and the objects added by the action.</span></p><pre style="max-height:350px;"><code class="language-cpp">      auto params = _factory.getValidParams(&quot;GenericConstantArray&quot;);
      params.set&lt;std::string&gt;(&quot;prop_name&quot;) = &quot;dc&quot;;
      params.set&lt;RealEigenVector&gt;(&quot;prop_value&quot;) =
          getParam&lt;RealEigenVector&gt;(&quot;diffusion_coefficients&quot;);
      _problem-&gt;addMaterial(&quot;GenericConstantArray&quot;, &quot;dc&quot;, params);

      // pass the control to the material by connecting them
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#66f0e546-cd23-42e0-bc2d-8fc2f4071f8f">(moose/test/src/actions/AddLotsOfDiffusion.C)</a></div></div><p>The action controllable parameter can be referred as usual in an input file. For example,</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 5: </span><span class="moose-caption-text" id="controls_example3">Example of a &quot;Action&quot; block that contains a parameter that is controlled via a                  MOOSE Control object.</span></p><pre style="max-height:350px;"><code class="language-moose">[Controls&lt;&lt;&lt;{&quot;href&quot;: &quot;index.html&quot;}&gt;&gt;&gt;]
  [setdc]
    type = RealVectorFunctionControl
    function = dc
    parameter = Testing/LotsOfDiffusion/lots/diffusion_coefficients
    execute_on = timestep_begin
  []
[]</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#468d2f29-19df-47f9-af2a-8b8184c3c143">(moose/test/tests/controls/action_control/action_control_test.i)</a></div></div></section><section class="scrollspy" id="e723b931-7710-48e3-948c-5cc67ea0c68a" data-section-level="2" data-section-text="Child Objects"><h2 id="child-objects">Child Objects</h2></section><section class="scrollspy" id="8553c023-f5ba-482c-9cb4-aa2e15f38fd4" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/controls/BoolFunctionControl.html">BoolFunctionControl</a>Sets the value of a &#x27;bool&#x27; input parameters to the value of a provided function.</li><li class="collection-item"><a href="../../source/controls/ConditionalFunctionEnableControl.html">ConditionalFunctionEnableControl</a>Control for enabling/disabling objects when a function value is true</li><li class="collection-item"><a href="../../source/controls/PIDTransientControl.html">PIDTransientControl</a>Sets the value of a &#x27;Real&#x27; input parameter (or postprocessor) based on a Proportional Integral Derivative control of a postprocessor to match a target a target value.</li><li class="collection-item"><a href="../../source/controls/RealFunctionControl.html">RealFunctionControl</a>Sets the value of a &#x27;Real&#x27; input parameters to the value of a provided function.</li><li class="collection-item"><a href="../../source/controls/TimePeriod.html">TimePeriod</a>Control the enabled/disabled state of objects with time.</li><li class="collection-item"><a href="../../source/controls/TimesEnableControl.html">TimesEnableControl</a>Control for enabling/disabling objects when a certain time is reached.</li><li class="collection-item"><a href="../../source/controls/WebServerControl.html">WebServerControl</a>Starts a webserver for sending/receiving JSON messages to get data and control a running MOOSE calculation</li></ul></section><section class="scrollspy" id="bd3de506-8c9f-4ed4-a873-cf281c5411c4" data-section-level="2" data-section-text="Associated Actions"><h2 id="associated-actions">Associated Actions</h2></section><section class="scrollspy" id="b01291a9-f03c-49b0-a376-933635b30e90" data-section-level="2" data-section-text="Available Actions"><h2 id="available-actions">Available Actions</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/actions/AddControlAction.html">AddControlAction</a>Add a Control object to the simulation.</li></ul></section></section><div class="moose-modal modal" id="fb40f271-e67f-481f-b2a0-8f6825fd10f4"><div class="modal-content"><h4>(moose/test/tests/controls/real_function_control/real_function_control.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 2
  nx = 10
  ny = 10
[]

[Variables]
  [./u]
  [../]
[]

[Kernels]
  [./diff]
    type = CoefDiffusion
    variable = u
    coef = 0.1
  [../]
  [./time]
    type = TimeDerivative
    variable = u
  [../]
[]

[BCs]
  [./left]
    type = DirichletBC
    variable = u
    boundary = left
    value = 0
  [../]
  [./right]
    type = DirichletBC
    variable = u
    boundary = right
    value = 1
  [../]
[]

[Executioner]
  type = Transient
  num_steps = 10
  dt = 0.1
  dtmin = 0.1
  solve_type = PJFNK
  petsc_options_iname = &#x27;-pc_type -pc_hypre_type&#x27;
  petsc_options_value = &#x27;hypre boomeramg&#x27;
[]

[Outputs]
  csv = true
[]

[Functions]
  [./func_coef]
    type = ParsedFunction
    expression = &#x27;2*t + 0.1&#x27;
  [../]
[]

[Postprocessors]
  [./coef]
    type = RealControlParameterReporter
    parameter = &#x27;Kernels/diff/coef&#x27;
  [../]
[]

[Controls]
  [./func_control]
    type = RealFunctionControl
    parameter = &#x27;*/*/coef&#x27;
    function = &#x27;func_coef&#x27;
    execute_on = &#x27;initial timestep_begin&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="e409a2bd-7724-4e93-bee7-2bc0769111af"><div class="modal-content"><h4>(moose/framework/src/bcs/DirichletBC.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;DirichletBC.h&quot;

registerMooseObject(&quot;MooseApp&quot;, DirichletBC);

InputParameters
DirichletBC::validParams()
{
  InputParameters params = DirichletBCBase::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;Value of the BC&quot;);
  params.declareControllable(&quot;value&quot;);
  params.addClassDescription(&quot;Imposes the essential boundary condition $u=g$, where $g$ &quot;
                             &quot;is a constant, controllable value.&quot;);
  return params;
}

DirichletBC::DirichletBC(const InputParameters &amp; parameters)
  : DirichletBCBase(parameters), _value(getParam&lt;Real&gt;(&quot;value&quot;))
{
}

Real
DirichletBC::computeQpValue()
{
  return _value;
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="73624009-9cbd-4669-abed-f344d6d4616d"><div class="modal-content"><h4>(moose/framework/include/bcs/DirichletBC.h)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#pragma once

#include &quot;DirichletBCBase.h&quot;

/**
 * Boundary condition of a Dirichlet type
 *
 * Sets the value in the node
 */
class DirichletBC : public DirichletBCBase
{
public:
  static InputParameters validParams();

  DirichletBC(const InputParameters &amp; parameters);

protected:
  virtual Real computeQpValue() override;

  /// The value for this BC
  const Real &amp; _value;
};
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="5bb1b507-232d-449a-aa62-80892d48128a"><div class="modal-content"><h4>(moose/framework/src/bcs/DirichletBC.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;DirichletBC.h&quot;

registerMooseObject(&quot;MooseApp&quot;, DirichletBC);

InputParameters
DirichletBC::validParams()
{
  InputParameters params = DirichletBCBase::validParams();
  params.addRequiredParam&lt;Real&gt;(&quot;value&quot;, &quot;Value of the BC&quot;);
  params.declareControllable(&quot;value&quot;);
  params.addClassDescription(&quot;Imposes the essential boundary condition $u=g$, where $g$ &quot;
                             &quot;is a constant, controllable value.&quot;);
  return params;
}

DirichletBC::DirichletBC(const InputParameters &amp; parameters)
  : DirichletBCBase(parameters), _value(getParam&lt;Real&gt;(&quot;value&quot;))
{
}

Real
DirichletBC::computeQpValue()
{
  return _value;
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="0ea4ed8c-cfa6-4193-9011-13c227756c41"><div class="modal-content"><h4>(moose/test/tests/controls/tag_based_naming_access/param.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
    control_tags = &#x27;tag&#x27;
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = TestControlPointPP
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
  [./other_point_test_object]
    type = TestControlPointPP
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f4a8ff50-dbda-4009-ae76-7bcf9b35d940"><div class="modal-content"><h4>(moose/test/tests/controls/tag_based_naming_access/param.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Mesh]
  type = GeneratedMesh
  dim = 2
  elem_type = QUAD4

  # use odd numbers so points do not fall on element boundaries
  nx = 31
  ny = 31
[]

[Variables]
  [./diffused]
    order = FIRST
    family = LAGRANGE
  [../]
[]

[Kernels]
  [./diff]
    type = Diffusion
    variable = diffused
  [../]
[]

[DiracKernels]
  [./test_object]
    type = MaterialPointSource
    point = &#x27;0.5 0.5 0&#x27;
    variable = diffused
    control_tags = &#x27;tag&#x27;
  [../]
[]

[BCs]
  [./bottom_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;bottom&#x27;
    value = 2
  [../]

  [./top_diffused]
    type = DirichletBC
    variable = diffused
    boundary = &#x27;top&#x27;
    value = 0
  [../]
[]

[Materials]
  [./mat]
    type = GenericConstantMaterial
    prop_names = &#x27;matp&#x27;
    prop_values = &#x27;1&#x27;
    block = 0
  [../]
[]

[Postprocessors]
  [./test_object]
    type = TestControlPointPP
    function = &#x27;2*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
  [./other_point_test_object]
    type = TestControlPointPP
    function = &#x27;3*(x+y)&#x27;
    point = &#x27;0.5 0.5 0&#x27;
    control_tags = &#x27;tag&#x27;
  [../]
[]

[Executioner]
  type = Steady
  solve_type = &#x27;PJFNK&#x27;
[]

[Outputs]
  execute_on = &#x27;timestep_end&#x27;
  exodus = true
[]

[Controls]
  [./point_control]
    type = TestControl
    test_type = &#x27;point&#x27;
    parameter = &#x27;tag/*/point&#x27;
    execute_on = &#x27;initial&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="66f0e546-cd23-42e0-bc2d-8fc2f4071f8f"><div class="modal-content"><h4>(moose/test/src/actions/AddLotsOfDiffusion.C)</h4><pre style="max-height:350px;"><code class="language-cpp">// This file is part of the MOOSE framework
// https://mooseframework.inl.gov
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;AddLotsOfDiffusion.h&quot;
#include &quot;Parser.h&quot;
#include &quot;FEProblem.h&quot;
#include &quot;Factory.h&quot;
#include &quot;MooseEnum.h&quot;
#include &quot;AddVariableAction.h&quot;
#include &quot;Conversion.h&quot;
#include &quot;DirichletBC.h&quot;
#include &quot;AddVariableAction.h&quot;

#include &lt;sstream&gt;
#include &lt;stdexcept&gt;

#include &quot;libmesh/libmesh.h&quot;
#include &quot;libmesh/exodusII_io.h&quot;
#include &quot;libmesh/equation_systems.h&quot;
#include &quot;libmesh/nonlinear_implicit_system.h&quot;
#include &quot;libmesh/explicit_system.h&quot;
#include &quot;libmesh/string_to_enum.h&quot;
#include &quot;libmesh/fe.h&quot;

registerMooseAction(&quot;MooseTestApp&quot;, AddLotsOfDiffusion, &quot;add_variable&quot;);
registerMooseAction(&quot;MooseTestApp&quot;, AddLotsOfDiffusion, &quot;add_kernel&quot;);
registerMooseAction(&quot;MooseTestApp&quot;, AddLotsOfDiffusion, &quot;add_bc&quot;);
registerMooseAction(&quot;MooseTestApp&quot;, AddLotsOfDiffusion, &quot;add_material&quot;);

InputParameters
AddLotsOfDiffusion::validParams()
{
  InputParameters params = Action::validParams();

  MooseEnum order(
      &quot;CONSTANT FIRST SECOND THIRD FOURTH FIFTH SIXTH SEVENTH EIGHTH NINTH&quot;, &quot;FIRST&quot;, true);
  params.addParam&lt;MooseEnum&gt;(&quot;order&quot;,
                             order,
                             &quot;Order of the FE shape function to use for this variable (additional &quot;
                             &quot;orders not listed here are allowed, depending on the family).&quot;);

  MooseEnum family(&quot;LAGRANGE MONOMIAL HERMITE SCALAR HIERARCHIC CLOUGH XYZ SZABAB BERNSTEIN &quot;
                   &quot;L2_LAGRANGE L2_HIERARCHIC NEDELEC_ONE LAGRANGE_VEC&quot;,
                   &quot;LAGRANGE&quot;);
  params.addParam&lt;MooseEnum&gt;(
      &quot;family&quot;, family, &quot;Specifies the family of FE shape functions to use for this variable.&quot;);
  params.addParam&lt;bool&gt;(&quot;array&quot;, false, &quot;Whether or not to use array variables&quot;);
  params.addRequiredParam&lt;unsigned int&gt;(&quot;number&quot;, &quot;The number of variables to add&quot;);
  params.addParam&lt;unsigned int&gt;(&quot;n_components&quot;, 2, &quot;The number of components of array variables&quot;);
  params.addParam&lt;bool&gt;(&quot;add_reaction&quot;, false, &quot;True to add reaction kernels&quot;);

  params.addRequiredParam&lt;RealEigenVector&gt;(&quot;diffusion_coefficients&quot;,
                                           &quot;Diffusion coefficient to be used by all variables&quot;);
  params.declareControllable(&quot;diffusion_coefficients&quot;);
  return params;
}

AddLotsOfDiffusion::AddLotsOfDiffusion(const InputParameters &amp; params) : Action(params) {}

void
AddLotsOfDiffusion::act()
{
  unsigned int number = getParam&lt;unsigned int&gt;(&quot;number&quot;);
  unsigned int ncomp = getParam&lt;unsigned int&gt;(&quot;n_components&quot;);

  const auto array = getParam&lt;bool&gt;(&quot;array&quot;);

  if (_current_task == &quot;add_variable&quot;)
  {
    auto fe_type = AddVariableAction::feType(_pars);
    auto type = AddVariableAction::variableType(fe_type, false, array);
    auto var_params = _factory.getValidParams(type);

    var_params.set&lt;MooseEnum&gt;(&quot;family&quot;) = getParam&lt;MooseEnum&gt;(&quot;family&quot;);
    var_params.set&lt;MooseEnum&gt;(&quot;order&quot;) = getParam&lt;MooseEnum&gt;(&quot;order&quot;);
    if (array)
      var_params.set&lt;unsigned int&gt;(&quot;components&quot;) = ncomp;
    for (unsigned int cur_num = 0; cur_num &lt; number; cur_num++)
    {
      std::string var_name = name() + Moose::stringify(cur_num);
      _problem-&gt;addVariable(type, var_name, var_params);
    }
  }
  else if (_current_task == &quot;add_kernel&quot;)
  {
    for (unsigned int cur_num = 0; cur_num &lt; number; cur_num++)
    {
      std::string var_name = name() + Moose::stringify(cur_num);
      {
        const auto kernel_type = array ? &quot;ArrayDiffusion&quot; : &quot;Diffusion&quot;;

        InputParameters params = _factory.getValidParams(kernel_type);
        params.set&lt;NonlinearVariableName&gt;(&quot;variable&quot;) = var_name;
        if (array)
          params.set&lt;MaterialPropertyName&gt;(&quot;diffusion_coefficient&quot;) = &quot;dc&quot;;
        _problem-&gt;addKernel(kernel_type, var_name, params);
      }

      if (getParam&lt;bool&gt;(&quot;add_reaction&quot;))
      {
        const auto kernel_type = array ? &quot;ArrayReaction&quot; : &quot;Reaction&quot;;
        InputParameters params = _factory.getValidParams(kernel_type);
        params.set&lt;NonlinearVariableName&gt;(&quot;variable&quot;) = var_name;
        if (array)
          params.set&lt;MaterialPropertyName&gt;(&quot;reaction_coefficient&quot;) = &quot;rc&quot;;
        _problem-&gt;addKernel(kernel_type, var_name + &quot;_reaction&quot;, params);
      }
    }
  }
  else if (_current_task == &quot;add_bc&quot;)
  {
    for (unsigned int cur_num = 0; cur_num &lt; number; cur_num++)
    {
      std::string var_name = name() + Moose::stringify(cur_num);
      const auto bc_type = array ? &quot;ArrayDirichletBC&quot; : &quot;DirichletBC&quot;;

      InputParameters params = _factory.getValidParams(bc_type);
      params.set&lt;NonlinearVariableName&gt;(&quot;variable&quot;) = var_name;
      params.set&lt;std::vector&lt;BoundaryName&gt;&gt;(&quot;boundary&quot;).push_back(&quot;left&quot;);
      if (array)
        params.set&lt;RealEigenVector&gt;(&quot;values&quot;) = RealEigenVector::Constant(ncomp, 0);
      else
        params.set&lt;Real&gt;(&quot;value&quot;) = 0;

      _problem-&gt;addBoundaryCondition(bc_type, var_name + &quot;_left&quot;, params);

      params.set&lt;std::vector&lt;BoundaryName&gt;&gt;(&quot;boundary&quot;)[0] = &quot;right&quot;;
      if (array)
        params.set&lt;RealEigenVector&gt;(&quot;values&quot;) = RealEigenVector::Constant(ncomp, 1);
      else
        params.set&lt;Real&gt;(&quot;value&quot;) = 1;

      _problem-&gt;addBoundaryCondition(bc_type, var_name + &quot;_right&quot;, params);
    }
  }
  else if (_current_task == &quot;add_material&quot; &amp;&amp; array)
  {
    {
      auto params = _factory.getValidParams(&quot;GenericConstantArray&quot;);
      params.set&lt;std::string&gt;(&quot;prop_name&quot;) = &quot;dc&quot;;
      params.set&lt;RealEigenVector&gt;(&quot;prop_value&quot;) =
          getParam&lt;RealEigenVector&gt;(&quot;diffusion_coefficients&quot;);
      _problem-&gt;addMaterial(&quot;GenericConstantArray&quot;, &quot;dc&quot;, params);

      // pass the control to the material by connecting them
      connectControllableParams(
          &quot;diffusion_coefficients&quot;, &quot;GenericConstantArray&quot;, &quot;dc&quot;, &quot;prop_value&quot;);
    }

    if (getParam&lt;bool&gt;(&quot;add_reaction&quot;))
    {
      auto params = _factory.getValidParams(&quot;GenericConstantArray&quot;);
      params.set&lt;std::string&gt;(&quot;prop_name&quot;) = &quot;rc&quot;;
      params.set&lt;RealEigenVector&gt;(&quot;prop_value&quot;) = RealEigenVector::Constant(ncomp, 1);
      _problem-&gt;addMaterial(&quot;GenericConstantArray&quot;, &quot;rc&quot;, params);
    }
  }
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="468d2f29-19df-47f9-af2a-8b8184c3c143"><div class="modal-content"><h4>(moose/test/tests/controls/action_control/action_control_test.i)</h4><pre style="max-height:350px;"><code class="language-moose">[Problem]
  use_hash_table_matrix_assembly = true
[]

[Mesh]
  [gmg]
    type = GeneratedMeshGenerator
    dim = 2
    nx = 3
    ny = 3
  []
[]

[Testing/LotsOfDiffusion/lots]
  number = 10
  array = true
  n_components = 4
  diffusion_coefficients = &#x27;1 1 1 1&#x27;
  add_reaction = true
[]

[Functions]
  [dc]
    type = ParsedFunction
    expression = t+1
  []
[]

[Controls]
  [setdc]
    type = RealVectorFunctionControl
    function = dc
    parameter = Testing/LotsOfDiffusion/lots/diffusion_coefficients
    execute_on = timestep_begin
  []
[]

[Executioner]
  type = Transient
  num_steps = 10
[]

[Outputs]
  exodus = true
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#297b983a-28e1-4402-b5ac-d0eced613541" class="tooltipped" data-position="left" data-tooltip="Making a Parameter Controllable">Making a Parameter Controllable</a></li><li><a href="#00614da0-0a28-49f5-bbe6-b5b9d4851beb" class="tooltipped" data-position="left" data-tooltip="Developing a New Control">Developing a New Control</a></li><li><a href="#6346823d-ff6a-478d-b6cf-5b66b441625f" class="tooltipped" data-position="left" data-tooltip="Object and Parameter Names">Object and Parameter Names</a></li><li><a href="#013703ce-9ae6-4f1f-9b55-b45ba9fe6442" class="tooltipped" data-position="left" data-tooltip="Controllable Parameters Added by Actions">Controllable Parameters Added by Actions</a></li><li><a href="#e723b931-7710-48e3-948c-5cc67ea0c68a" class="tooltipped" data-position="left" data-tooltip="Child Objects">Child Objects</a></li><li><a href="#8553c023-f5ba-482c-9cb4-aa2e15f38fd4" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li><li><a href="#bd3de506-8c9f-4ed4-a873-cf281c5411c4" class="tooltipped" data-position="left" data-tooltip="Associated Actions">Associated Actions</a></li><li><a href="#b01291a9-f03c-49b0-a376-933635b30e90" class="tooltipped" data-position="left" data-tooltip="Available Actions">Available Actions</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script><script type="text/javascript" src="../../js/moose_input_parser.js"></script>